FROM ubuntu:22.04

RUN apt-get update && \
    apt-get install -y redis-tools bc build-essential autoconf automake libpcre3-dev libevent-dev pkg-config zlib1g-dev git && \
    git clone https://github.com/RedisLabs/memtier_benchmark.git /memtier_benchmark && \
    cd /memtier_benchmark && autoreconf -ivf && ./configure && make && make install

WORKDIR /app
COPY tests /app/tests
ENTRYPOINT ["bash", "/app/tests/clt-bench.sh"]
